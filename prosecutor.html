<!DOCTYPE HTML>
<html>
<head>
	<title>The Simpson's Fallacy</title>
	<link href="styles.css" type="text/css" rel="stylesheet"/>
	<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
	<style>
		body p {
			font-size: 16px;
			line-height: 1.4em;
		}

		#form_wrapper {
			width: 100%;
			border: 2px dashed #ccc;
		}
		
		table {
			width: 390px;
			margin: 20px auto;
			border-collapse: collapse;
		}
		
		table th, table td {
			padding: 13px;
			border: 1px solid #ccc;
		}
		
		#wbypassp, #hbypassp, #wtransplantp, #htransplantp {
			float: right;
		}
		
		#reset_btn {
			display: block;
			margin: 0 auto;
			margin-bottom: 20px;
		}
	</style>

	<script>
		function numberWithCommas(x) {
		    return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
		}
		
		function calculate() {
			var wbypass = parseInt($("#wbypass").val());
			var hbypass = parseInt($("#hbypass").val());
			var wbypassprob = wbypass / 87;
			var hbypassprob = hbypass / 273;
			
			if (wbypassprob > hbypassprob) {
				$("#wbypassp").css("color", "green");
				$("#hbypassp").css("color", "red");
			} else {
				$("#wbypassp").css("color", "red");
				$("#hbypassp").css("color", "green");
			}
			
			$("#wbypassp").html("&asymp; " + Math.round(wbypassprob * 100) + "%");
			$("#hbypassp").html("&asymp; " + Math.round(hbypassprob * 100) + "%");
			
			var wtransplant = parseInt($("#wtransplant").val());
			var htransplant = parseInt($("#htransplant").val());
			var wtransplantprob = wtransplant / 263;
			var htransplantprob = htransplant / 77;
			
			if (wtransplantprob > htransplantprob) {
				$("#wtransplantp").css("color", "green");
				$("#htransplantp").css("color", "red");
			} else {
				$("#wtransplantp").css("color", "red");
				$("#htransplantp").css("color", "green");
			}
			
			$("#wtransplantp").html("&asymp; " + Math.round(wtransplantprob * 100) + "%");
			$("#htransplantp").html("&asymp; " + Math.round(htransplantprob * 100) + "%");
			
			var watson_overall = (wbypass + wtransplant) / 350;
			var holmes_overall = (hbypass + htransplant) / 350;
			
			// Classic Paradox!
			if (wbypassprob > hbypassprob && wtransplantprob > htransplantprob && holmes_overall > watson_overall) {
				$("#better_doctor").html("Given the data above, we see that Dr. Watson is better at both bypass surgeries and heart transplants than Dr. Holmes. Clearly, Dr. Watson must be the better doctor! But wait, this is the paradox!");
			}
		}
		
		$(document).ready(function() {
			$("input").change(function() {
				calculate();
			});
			
			$("#reset_btn").click(function() {
				$("#wbypass").val(86);
				$("#hbypass").val(250);
				$("#wtransplant").val(150);
				$("#htransplant").val(40);
				calculate();
			})
			calculate();
		});
	</script>
</head>

<body>
	<div id="wrapper">
		<h1 id="page_title">The Simpson's Fallacy</h1>

		<h2>The Situation</h2>
		<img src="images/surgeon.jpg" style="width: 250px; height: auto; float: left; margin-right: 20px;"/>
		<p>Let's imagine two heart surgeons, Dr. Watson and Dr. Holmes. Over the past 5 years, Dr. Watson has performed 87 Bypass Surgeries and 263 Heart Transplants, and Dr. Holmes has performed 273 Bypass Surgeries and 77 Heart Transplants.</p>
		<p>Imagine that we're trying to decide which is the better surgeon, and we have data on the number of successful surgeries of each type each doctor has performed. That data is listed below (feel free to play with other values as well!)</p>

		<div class="clear"></div>

		<h2>The Data</h2>
		<div id="form_wrapper">
			<table>
				<tr>
					<th></th>
					<th style="text-align: right;">Dr. Watson</th>
					<th style="text-align: right;">Dr. Holmes</th>
				</tr>
				<tr>
					<th style="text-align: left;">Bypass</th>
					<td><input type="number" min="0" max="87" value="86" id="wbypass" style="width: 30px"/> / 87 <b id="wbypassp"></b></td>
					<td><input type="number" min="0" max="273" value="250" id="hbypass" style="width: 37px"/> / 273 <b id="hbypassp"></b></td>
				</tr>
				<tr>
					<th style="text-align: left;">Transplant</th>
					<td><input type="number" min="0" max="263" value="150" id="wtransplant" style="width: 37px"/> / 263 <b id="wtransplantp"></b></td>
					<td><input type="number" min="0" max="77" value="40" id="htransplant" style="width: 30px"/> / 77 <b id="htransplantp"></b></td>
				</tr>
			</table>
			<button id="reset_btn">Reset Data</button>
		</div>
		
		<h2>Who's Better?</h2>
		<p id="better_doctor"></p>
	</div>
</body>

</html>